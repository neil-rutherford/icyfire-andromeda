{% extends "layout.html" %}

{% block content %}
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{{ url_for('help.help') }}">Help</a></li>
            <li class="breadcrumb-item"><a href="{{ url_for('help.help_topic', topic='api') }}">API</a></li>
            <li class="breadcrumb-item active" aria-current="page">Get information about a message</li>
        </ol>
    </nav>

    <h1 class="text-center">Get information about a message</h1>
    <p>Returns information about a given message. Takes <code>message_id</code> (message primary key, as an integer) as an argument.</p>
    <table class="table table-striped">
        <tr>
            <td>Endpoint</td>
            <td><code>/_api/get/message/[MESSAGE_ID]</code></td>
        </tr>
        <tr>
            <td>Method</td>
            <td><code>POST</code></td>
        </tr>
        <tr>
            <td>Form-encoded POST input</td>
            <td><code>{
                'consumer_key': [CONSUMER_KEY],
                'consumer_secret': [CONSUMER_SECRET]
            }</code></td>
        </tr>
        <tr>
            <td>On success</td>
            <td><ul>
            <li>200 status code</li>
            <li>JSON object</li>
            <li><code>{
                    'id': Primary key (int),
                    'reply_to': Message ID if it is a reply (int), else None,
                    'from_user_id': Sender user ID (int),
                    'to_user_id': Recipient user ID (int),
                    'subject': Subject line (str),
                    'body': Message body (str),
                    'sent_timestamp': When was the message sent, in UTC? (datetime),
                    'seen_timestamp': 'seen_timestamp': When was the message seen, in UTC? (datetime)
            }</code></li>
            </ul></td>
        </tr>
        <tr>
            <td>Example response</td>
            <td><code>{
                'id': 4456,
                'reply_to': null,
                'from_user_id': 56,
                'to_user_id': 1,
                'subject': 'I loved your article!',
                'body': "Hey, I just wanted to say that the article you wrote about aliens in Roswell was awesome! Keep up the good work!",
                'sent_timestamp': 2021-08-24T11:04:51.431223Z,
                'seen_timestamp': 2021-08-24T11:06:51.123456Z
            }</code></td>
        </tr>
        <tr>
            <td>Error messages</td>
            <td>
                <ul>
                    <li>403 (Client not found): Consumer key is incorrect.</li>
                    <li>403 (Incorrect credentials): Consumer secret is incorrect.</li>
                    <li>403 (API access has been restricted): Your credentials are correct, but your app is either not approved or on a blacklist.</li>
                    <li>403 (Insufficient permissions): You don't have permission to access that resource. Could also be trying to access a message that isn't yours.</li>
                    <li>404: Message not found.</li>
                    <li>429 (Too many requests): You have exceeded your rate limit.</li>
                </ul>
            </td>
        </tr>
    </table>
{% endblock %}